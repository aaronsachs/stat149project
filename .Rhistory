mod1 = hurdle(LOS-1~DIAGNOSIS|DRG,dist='poisson',data=ami)
mod2 = hurdle(LOS-1~DIAGNOSIS+AGE|DRG,dist='poisson',data=ami)
anova(mod1,mod2,test='Chisq')
mod1 = hurdle(LOS-1~DIAGNOSIS|DRG,dist='poisson',data=ami)
mod2 = hurdle(LOS-1~DIAGNOSIS+AGE|DRG,dist='poisson',data=ami)
if (!require(aod)) {install.packages("aod"); require(aod)}
library(MASS)
library(stats)
library(car)
library(pscl)
source('~/Documents/STAT149/proyecto/lucas/Functions.R')
# load in data
path <- '~/Documents/STAT149/proyecto/lucas/'
ami <- load.data(path)
str(ami)
ami <- ami[ami$CHARGES > 300,]
mod1 = hurdle(LOS-1~DIAGNOSIS|DRG,dist='poisson',data=ami)
mod2 = hurdle(LOS-1~DIAGNOSIS+AGE|DRG,dist='poisson',data=ami)
anova(mod1,mod2,test='Chisq')
anova(mod1,mod2,test='F')
pt(logLik(mod1)/logLik(mod2),df=1)
pt(logLik(mod1)[1]/logLik(mod2)[1],df=1)
if (!require(aod)) {install.packages("aod"); require(aod)}
import(MASS)
import(stats)
import(car)
import(pscl)
source('~/Documents/STAT149/proyecto/lucas/Functions.R')
# load in data
path <- '~/Documents/STAT149/proyecto/lucas/'
ami <- load.data(path)
str(ami)
ami <- ami[ami$CHARGES > 300,]
#######################################################################################
##############################          POISSON       #################################
##############################                        #################################
#######################################################################################
# DRG:AGE, DRG:LOGCHARGES, DIAGNOSIS:LOGCHARGES, DIAGNOSES:SEX,
#### with dropped data ########
model_str1 <- 'glm('
model_str2 <- ',family = \'poisson\', data = ami)'
predictors <- c('DIAGNOSIS' , 'SEX', 'DRG', 'LOGCHARGES' , 'AGE', 'LOGCHARGES.na')
dependent.name <- "LOS"
# find the best model
poisson.bm.str <- best_model(model_str1, model_str2, dependent.name, predictors, data = ami, test = 'Chisq')
poisson.bm <- glm(poisson.bm.str, family = 'poisson', data = ami)
summary(poisson.bm)
# diagnostic plots
diagnostic_plots(poisson.bm, "Gamma Full Effect Final Model")
current.formula <- poisson.bm.str
predictors.list <-  c('DIAGNOSIS:DRG','DIAGNOSIS:LOGCHARGES.na',
'DRG:SEX', 'DRG:LOGCHARGES.na', 'SEX:LOGCHARGES.na',
'LOGCHARGES:DIAGNOSIS', 'LOGCHARGES:SEX', 'LOGCHARGES:DRG',
'AGE:DIAGNOSIS')
poisson.bm.inter.str <- consider_predictors(model.str1, model.str2, current.formula, predictors.list, "Chisq")
poisson.bm.inter <- glm(poisson.bm.inter.str , family = 'poisson', data = ami)
summary(poisson.bm.inter)
diagnostic_plots(poisson.bm.inter, "Gamma Full Effect + Interactions Final Model")
poisson.bm.inter.str <- consider_predictors(model_str1, model_str2, current.formula, predictors.list, "Chisq")
poisson.bm.inter <- glm(poisson.bm.inter.str , family = 'poisson', data = ami)
summary(poisson.bm.inter)
diagnostic_plots(poisson.bm.inter, "Gamma Full Effect + Interactions Final Model")
mod1 = hurdle(LOS-1~DIAGNOSIS|DRG,dist='poisson',data=ami)
mod2 = hurdle(LOS-1~DIAGNOSIS+AGE|DRG,dist='poisson',data=ami)
odTest(mod1,mod2)
as.glm(mod1)
View(mod1)
1-pt(logLik(mod1)[1]/logLik(mod2)[1],df=1)
mod1 = hurdle(LOS-1~DIAGNOSIS+AGE|DRG,dist='poisson',data=ami)
mod2 = hurdle(LOS-1~DIAGNOSIS+AGE+CHARGES|DRG,dist='poisson',data=ami)
anova(mod1,mod2,test='Chisq')
1-pt(logLik(mod1)[1]/logLik(mod2)[1],df=1)
mod1 = hurdle(LOS-1~DIAGNOSIS+AGE|DRG,dist='poisson',data=ami)
mod2 = hurdle(LOS-1~DIAGNOSIS+AGE+CHARGES+SEX|DRG,dist='poisson',data=ami)
anova(mod1,mod2,test='Chisq')
1-pt(logLik(mod1)[1]/logLik(mod2)[1],df=1)
mod1 = hurdle(LOS-1~DIAGNOSIS+AGE|DRG,dist='poisson',data=ami)
mod2 = hurdle(LOS-1~DIAGNOSIS+AGE+CHARGES|DRG+SEX,dist='poisson',data=ami)
anova(mod1,mod2,test='Chisq')
1-pt(logLik(mod1)[1]/logLik(mod2)[1],df=1)
mod1 = hurdle(LOS-1~DIAGNOSIS+AGE|DRG,dist='poisson',data=ami)
mod2 = hurdle(LOS-1~DIAGNOSIS+AGE+CHARGES|DRG+SEX,dist='poisson',data=ami)
anova(mod1,mod2,test='Chisq')
1-pt(logLik(mod1)[1]/logLik(mod2)[1],df=2)
mod1 = hurdle(LOS-1~DIAGNOSIS+AGE|DRG,dist='poisson',data=ami)
mod2 = hurdle(LOS-1~DIAGNOSIS+AGE+CHARGES|DRG+SEX,dist='poisson',data=ami)
anova(mod1,mod2,test='Chisq')
1-pt(logLik(mod1)[1]/logLik(mod2)[1],df=30)
mod1 = hurdle(LOS-1~DIAGNOSIS+AGE|DRG,dist='poisson',data=ami)
mod2 = hurdle(LOS-1~DIAGNOSIS+AGE+CHARGES|DRG+SEX,dist='poisson',data=ami)
anova(mod1,mod2,test='Chisq')
1-pt(logLik(mod1)[1]/logLik(mod2)[1],df=300)
mod1 = hurdle(LOS-1~DIAGNOSIS+AGE|DRG,dist='poisson',data=ami)
mod2 = hurdle(LOS-1~DIAGNOSIS+AGE+CHARGES|DRG+SEX,dist='poisson',data=ami)
anova(mod1,mod2,test='Chisq')
1-pt(logLik(mod1)[1]/logLik(mod2)[1],df=3)
summary(poisson.bm.inter)
diagnostic_plots(poisson.bm.inter, "Gamma Full Effect + Interactions Final Model")
poisson.chi <- goodness.fit.model(poisson.bm)
poisson.inter.chi <- goodness.fit.model(poisson.bm.inter)
poisson.tchi <- test.chi.sq('glm(formula = gamma.bm.str, family = \'poisson\',')
poisson.inter.tchi <- test.chi.sq('glm(formula = gamma.bm.inter.str, family = \'poisson\',')
model <- c('Poisson','Poisson + Inter')
chi.stat <- c(poisson.chi,poisson.inter.chi)
test.chi.stat <- c(poisson.tchi)
pander(data.frame(names, chi.stat, test.chi.stat))
poisson.chi <- goodness.fit.model(poisson.bm)
poisson.inter.chi <- goodness.fit.model(poisson.bm.inter)
poisson.tchi <- test.chi.sq('glm(formula = gamma.bm.str, family = \'poisson\',')
poisson.inter.tchi <- test.chi.sq('glm(formula = gamma.bm.inter.str, family = \'poisson\',')
model <- c('Poisson','Poisson + Inter')
chi.stat <- c(poisson.chi,poisson.inter.chi)
test.chi.stat <- c(poisson.tchi,poisson.inter.tchi)
poisson.chi <- goodness.fit.model(poisson.bm)
poisson.inter.chi <- goodness.fit.model(poisson.bm.inter)
poisson.tchi <- test.chi.sq('glm(formula = poisson.bm.str, family = \'poisson\',')
poisson.inter.tchi <- test.chi.sq('glm(formula = poisson.bm.inter.str, family = \'poisson\',')
model <- c('Poisson','Poisson + Inter')
chi.stat <- c(poisson.chi,poisson.inter.chi)
test.chi.stat <- c(poisson.tchi,poisson.inter.tchi)
pander(data.frame(names, chi.stat, test.chi.stat))
import(pander)
install.packages("pander")
pander(data.frame(names, chi.stat, test.chi.stat))
import(pander)
install.packages("pander")
import(pander)
library(pander)
model <- c('Poisson','Poisson + Inter')
chi.stat <- c(poisson.chi,poisson.inter.chi)
test.chi.stat <- c(poisson.tchi,poisson.inter.tchi)
pander(data.frame(names, chi.stat, test.chi.stat))
data.frame(names, chi.stat, test.chi.stat)
pander(data.frame(model, chi.stat, test.chi.stat))
grid.table(data.frame(model, chi.stat, test.chi.stat),row = c('',''))
table(data.frame(model, chi.stat, test.chi.stat), row = c('',''))
importa('gridExtra')
import('gridExtra')
grid.table
grid.table(data.frame(model, chi.stat, test.chi.stat), row = c('',''))
dev.off()
grid.table(data.frame(model, chi.stat, test.chi.stat), row = c('',''))
poisson.chi
poisson.bm.str
mod1 <- hurdle((LOS-1) ~ poisson.bm.str, dist='dist',data=ami)
mod1 <- hurdle((LOS-1) ~ poisson.bm.str, dist='poisson',data=ami)
poisson.bm.str
mod1 <- hurdle((LOS-1) ~ LOGCHARGES+DRG+AGE+LOGCHARGES.na+DIAGNOSIS+SEX
|LOGCHARGES, dist='poisson',data=ami)
mod1
View(ami)
mod1 <- hurdle((LOS-1) ~ LOGCHARGES+DRG+AGE+LOGCHARGES.na+DIAGNOSIS+SEX
|LOGCHARGES+LOGRCHARGES.na, dist='poisson',data=ami)
mod1 <- hurdle((LOS-1) ~ LOGCHARGES+DRG+AGE+LOGCHARGES.na+DIAGNOSIS+SEX
|LOGCHARGES+LOGCHARGES.na, dist='poisson',data=ami)
